> 目前常用的Redis客户端有Jedis和Lettuce  
> 其中因为Jedis是非线程安全的、阻塞的客户端，在多线程的使用场景下，需要配合连接池一起使用。而Lettuce是基于Netty实现，不需要使用连接池，且是非阻塞的。推荐在项目中使用Lettuce客户端操作Redis。
  
spring-data-redis是隶属于Spring Data系列，可以很方便的在spring应用中配置实现Redis的访问，提供了对底层api的高度封装，使对Redis的操作更加方便。譬如，提供了redisTemplate,每次操作完Redis，不需要手动释放连接。  

Spring提供了一个RedisConnectionFactory接口，并提供了针对Jedis的实现类JedisConnectionFactory和针对Lettuce的实现类LettuceConnectionFactory，通过它可以生成RedisConnection接口对象，而RedisConnection接口对象是对Redis客户端的封装，Spring为我们提供了JedisConnection（JedisClusterConnection）和LettuceConnection(LettuceClusterConnection)。要获取RedisConnection连接对象需要先创建RedisConnectionFactory。因为目前广泛使用的还是Jedis，故在本系列文章中还是以Jedis作为客户端，而Jedis的实现JedisConnectionFactory工厂类主要是对连接池的配置。下面是一个Redis单节点的配置示例。
	
	public RedisConnectionFactory redisConnectionFactory() {
		JedisPoolConfig config = new JedisConfig();
		config.setMaxIdle(30);
		config.setMaxTotal(100);

		RedisConnectionFactory factory = new JedisConnectionFactory(config);
		factory.setHostHome("localhost");
		factory.setPort(6379);

		return factory;
	}

注：上述配置方式已经过时，只是为了展示连接池才进行使用，在项目中尽量使用最新的配置方式。具体请查看spring-data-redis包下的JedisConnectionFactory类。关于连接池的相关知识可以参考[连接池](../../../basic/util/连接池.md)

Spring为我们提供了RedisTemplate类帮助我们通过RedisConnection操作Redis。它会自动从RedisConnectionFactory中获取连接，在使用完之后还会关闭Redis的连接，开发者在使用RedisTemplate时无需关注Redis的闭合问题。  

	public RedisTemplate<String, Object> redisTemplate() {
		RedisTemplate<String, Object> redisTemplate = new RedisTemplate();
		redisTemplate.setConnectionFactory(redisConnectionFactory());
		rerurn redisTemplate;
	}

为了更方便的使用redis，spring提供了spring-boot-starter-data-redis（官方Starter，其自动配置类集中在在spring-boot-autoconfigure中）。在spring-boot 2.x之后，默认使用lettuce客户端进行配置。如果需要使用Jedis作为底层客户端，可以将Lettuce排除，然后引入Jedis的引用即可。 

序列化
---

在使用RedisTemplate进行存取的时候，需要设置key、value的序列化方式，spring-data-redis为我们提供了RedisSerializer序列化接口以及5个实现类。  
	
	public interface RedisSerializer<T> {
	    @Nullable
	    byte[] serialize(@Nullable T var1) throws SerializationException;
	
	    @Nullable
	    T deserialize(@Nullable byte[] var1) throws SerializationException;
	}

- JdkSerializationRedisSerializer:默认的序列化方式，被序列化的对象需要实现Serializable接口，序列化之后长度长，并且不易阅读。
- StringRedisSerializer:简单的字符串序列化方式。String.getByte()和new String(byte[] bytes)
- GenericToStringSerializer:
- Jackson2JsonRedisSerializer:
- GenericJackson2JsonRedisSerializer:
